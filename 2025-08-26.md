---
title: Custom Desmos Thumbnail
tags:
  - blog
  - desmos
created: 2025-08-26T12:43
updated: 2025-08-26T15:33
description: Do you want to customize your graph on desmos first before sharing it?
---
# Preview
Artist:
https://x.com/miwakokuMWKK/status/1959548465522040865


![Screenshot_20250826_124855.png](https://res.cloudinary.com/kumonochisanaka/image/upload/v1756226957/20250826124916851.png/2033d52a4a45f8485f3afdf277b9d248.png)

https://www.desmos.com/calculator/00mgvlsxtk

I reported this to desmos team on discord via a ticket but they just closed my ticket, I guess this is allowed.

# How I found it

I am using LibreWolf, which has canvas fingerprinting blocking feature.

This means canvas will work normally, but if the page tries to read pixel values from the canvas, it will get noise.

When I shared my saved desmos chart on discord.

![image.png](https://res.cloudinary.com/kumonochisanaka/image/upload/v1756228437/20250826131357174.png/1042d4f268163ec0c5906bb9215a88ea.png)

The embed showed noise instead of the graph.

This means desmos is serving an image that was drawn locally on my browser and uploaded onto the server.

# How it works

We can just skip over the investigation part because it was straight forward "look at network tab in devtools".

But basically `/api/v1/calculator-shared/save` takes in the following data.

```js
{
  recoveryParentHash: docID,
  thumbnailData: thumbnail,  // data:image/png;base64,...
  hash: docID,
  type: "my-graph",
  title: title,
  state: JSON.stringify(state), // the graph itself is stored inside here
  product: "graphing",
  currentVersion: uuid,
}
```

We can get `state` and other information from `/calculator/DOCID`.

The server only checks for `data:image/png;base64` and does not actually verify that it is a chart, nor verify if its an PNG, nor verify that it is actually an image.

We can upload anything to demos as the thumbnail, even arbitrary binaries.

```
❯ curl https://www.desmos.com/calc_thumbs/production/version/4umynhg3vp/1c645b90-82a1-11f0-9f38-eb0548fa3851.png
owo using desmos for hosting?%
```

Note that the `Content-Type` header sent by the server is still `image/png`, so we can't actually show HTML pages here (which would be funny).

```js
async function api(path, options) {
  const url = new URL("https://www.desmos.com" + path);
  return await fetch(url, {
    headers: {
      Accept: "application/json",
      Cookie: "sid=...", // you need to use your own cookie here
      "Content-Type": "application/json",
    },
    mode: "cors",
    ...(options ?? {}),
  });
}

const docID = "4umynhg3vp"; // replace with yours

const doc = await api(`/calculator/${docID}`).then((r) => r.json());
const state = doc.state;
// you can read buffer from a file instead to upload
// png and jpgs both work, svg dont
const buffer = Buffer.from("owo using desmos for hosting?");
state.thumbnailData = "data:image/png;base64," + buffer.toString("base64");

const data = {
  recoveryParentHash: docID,
  thumbnailData: thumbnail,
  hash: docID,
  type: "my-graph",
  title: doc.title,
  state: JSON.stringify(state),
  product: "graphing",
  currentVersion: doc.currentVersion,
};
console.log(
  await api("/api/v1/calculator-shared/save", {
    method: "POST",
    body: JSON.stringify(data),
  }).then((res) => res.json())
);
```

And that's it.
